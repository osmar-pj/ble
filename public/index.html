<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>GUNJOP - UNDIS</title>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <div class="sync-corner" id="syncCorner" aria-label="Estado de sincronización" style="display: none;">
    <span id="syncLabel">—</span>
  </div>
  <div class="wifi-corner off" id="wifiCorner" aria-label="Estado WiFi">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
      <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.7 2.09 7.3 2.09 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
    </svg>
    <span id="wifiLabel">—</span>
  </div>
  <header class="header">
    <span class="header-unit" id="headerUnitId">—</span>
  </header>
  <div class="config-warn" id="configWarn" style="display: none;"></div>
  <nav class="tabs" role="tablist">
    <button type="button" role="tab" id="tabLive" aria-selected="true">En vivo</button>
    <button type="button" role="tab" id="tabHistory" aria-selected="false">Historial</button>
    <button type="button" role="tab" id="tabSettings" aria-selected="false">Configuración</button>
  </nav>
  <p class="status" id="status" aria-live="polite">Escaneo automático (MAC AF2024)</p>
  <div id="viewLive" class="view active" role="tabpanel">
    <div id="liveWrap">
      <table>
        <thead>
          <tr>
            <th>Beacon</th>
            <th>RSSI</th>
            <th>Inicio detección</th>
          </tr>
        </thead>
        <tbody id="list"></tbody>
      </table>
    </div>
    <p class="empty" id="liveEmpty">No hay dispositivos. El escaneo es automático.</p>
  </div>
  <div id="viewHistory" class="view" role="tabpanel">
    <div id="sessionsWrap">
      <table>
        <thead>
          <tr>
            <th>Beacon</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Duración</th>
          </tr>
        </thead>
        <tbody id="sessionsTable"></tbody>
      </table>
    </div>
    <p class="empty" id="sessionsEmpty">Sin sesiones registradas</p>
  </div>
  <div id="viewSettings" class="view" role="tabpanel">
    <form id="settingsForm" class="settings-form">
      <fieldset class="settings-group">
        <legend>MQTT</legend>
        <label>
          <span>URL</span>
          <input type="text" name="MQTT_URL" placeholder="mqtt://host:1883">
        </label>
        <label>
          <span>Topic</span>
          <input type="text" name="MQTT_TOPIC" placeholder="porvenir/unit/truck_20">
        </label>
        <label>
          <span>Client ID</span>
          <input type="text" name="MQTT_CLIENT_ID" placeholder="truck_20">
        </label>
        <label>
          <span>Usuario</span>
          <input type="text" name="MQTT_USERNAME" placeholder="">
        </label>
        <label>
          <span>Contraseña</span>
          <input type="password" name="MQTT_PASSWORD" placeholder="">
        </label>
      </fieldset>
      <fieldset class="settings-group">
        <legend>Sync</legend>
        <label>
          <span>Servidor URL</span>
          <input type="text" name="SYNC_SERVER_URL" placeholder="http://192.168.1.50">
        </label>
      </fieldset>
      <fieldset class="settings-group">
        <legend>Unidad y Bluetooth</legend>
        <label>
          <span>Unit ID</span>
          <input type="text" name="UNIT_ID" placeholder="truck_20">
        </label>
        <label>
          <span>MAC Filter</span>
          <input type="text" name="MAC_FILTER" placeholder="AF2024">
        </label>
        <label>
          <span>RSSI Stale (ms)</span>
          <input type="number" name="RSSI_STALE_MS" placeholder="10000">
        </label>
      </fieldset>
      <p class="settings-status" id="settingsStatus"></p>
      <button type="submit" class="scan-btn">Guardar configuración</button>
    </form>
  </div>

  <script src="/js/app.js"></script>
  <script src="/js/virtual-keyboard.js"></script>
</body>
</html>
